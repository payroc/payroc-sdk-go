// Code generated by Fern. DO NOT EDIT.

package boarding_processing_accounts_test

import (
	bytes "bytes"
	context "context"
	json "encoding/json"
	payroc "github.com/payroc/payroc-sdk-go"
	boarding "github.com/payroc/payroc-sdk-go/boarding"
	client "github.com/payroc/payroc-sdk-go/client"
	option "github.com/payroc/payroc-sdk-go/option"
	require "github.com/stretchr/testify/require"
	http "net/http"
	testing "testing"
)

func VerifyRequestCount(
	t *testing.T,
	testId string,
	method string,
	urlPath string,
	queryParams map[string]string,
	expected int,
) {
	WiremockAdminURL := "http://localhost:8080/__admin"
	var reqBody bytes.Buffer
	reqBody.WriteString(`{"method":"`)
	reqBody.WriteString(method)
	reqBody.WriteString(`","urlPath":"`)
	reqBody.WriteString(urlPath)
	reqBody.WriteString(`","headers":{"X-Test-Id":{"equalTo":"`)
	reqBody.WriteString(testId)
	reqBody.WriteString(`"}}`)
	if len(queryParams) > 0 {
		reqBody.WriteString(`,"queryParameters":{`)
		first := true
		for key, value := range queryParams {
			if !first {
				reqBody.WriteString(",")
			}
			reqBody.WriteString(`"`)
			reqBody.WriteString(key)
			reqBody.WriteString(`":{"equalTo":"`)
			reqBody.WriteString(value)
			reqBody.WriteString(`"}`)
			first = false
		}
		reqBody.WriteString("}")
	}
	reqBody.WriteString("}")
	resp, err := http.Post(WiremockAdminURL+"/requests/find", "application/json", &reqBody)
	require.NoError(t, err)
	var result struct {
		Requests []interface{} `json:"requests"`
	}
	json.NewDecoder(resp.Body).Decode(&result)
	require.Equal(t, expected, len(result.Requests))
}

func TestBoardingProcessingAccountsRetrieveWithWireMock(
	t *testing.T,
) {
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewPayrocClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &boarding.RetrieveProcessingAccountsRequest{
		ProcessingAccountId: "38765",
	}
	_, invocationErr := client.Boarding.ProcessingAccounts.Retrieve(
		context.TODO(),
		request,
		option.WithHTTPHeader(
			http.Header{"X-Test-Id": []string{"TestBoardingProcessingAccountsRetrieveWithWireMock"}},
		),
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "TestBoardingProcessingAccountsRetrieveWithWireMock", "GET", "/processing-accounts/38765", nil, 1)
}

func TestBoardingProcessingAccountsListProcessingAccountFundingAccountsWithWireMock(
	t *testing.T,
) {
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewPayrocClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &boarding.ListProcessingAccountFundingAccountsRequest{
		ProcessingAccountId: "38765",
	}
	_, invocationErr := client.Boarding.ProcessingAccounts.ListProcessingAccountFundingAccounts(
		context.TODO(),
		request,
		option.WithHTTPHeader(
			http.Header{"X-Test-Id": []string{"TestBoardingProcessingAccountsListProcessingAccountFundingAccountsWithWireMock"}},
		),
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "TestBoardingProcessingAccountsListProcessingAccountFundingAccountsWithWireMock", "GET", "/processing-accounts/38765/funding-accounts", nil, 1)
}

func TestBoardingProcessingAccountsListContactsWithWireMock(
	t *testing.T,
) {
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewPayrocClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &boarding.ListContactsProcessingAccountsRequest{
		ProcessingAccountId: "38765",
		Before: payroc.String(
			"2571",
		),
		After: payroc.String(
			"8516",
		),
		Limit: payroc.Int(
			1,
		),
	}
	_, invocationErr := client.Boarding.ProcessingAccounts.ListContacts(
		context.TODO(),
		request,
		option.WithHTTPHeader(
			http.Header{"X-Test-Id": []string{"TestBoardingProcessingAccountsListContactsWithWireMock"}},
		),
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "TestBoardingProcessingAccountsListContactsWithWireMock", "GET", "/processing-accounts/38765/contacts", map[string]string{"before": "2571", "after": "8516", "limit": "1"}, 1)
}

func TestBoardingProcessingAccountsGetProcessingAccountPricingAgreementWithWireMock(
	t *testing.T,
) {
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewPayrocClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &boarding.GetProcessingAccountPricingAgreementProcessingAccountsRequest{
		ProcessingAccountId: "38765",
	}
	_, invocationErr := client.Boarding.ProcessingAccounts.GetProcessingAccountPricingAgreement(
		context.TODO(),
		request,
		option.WithHTTPHeader(
			http.Header{"X-Test-Id": []string{"TestBoardingProcessingAccountsGetProcessingAccountPricingAgreementWithWireMock"}},
		),
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "TestBoardingProcessingAccountsGetProcessingAccountPricingAgreementWithWireMock", "GET", "/processing-accounts/38765/pricing", nil, 1)
}

func TestBoardingProcessingAccountsListOwnersWithWireMock(
	t *testing.T,
) {
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewPayrocClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &boarding.ListProcessingAccountOwnersRequest{
		ProcessingAccountId: "38765",
		Before: payroc.String(
			"2571",
		),
		After: payroc.String(
			"8516",
		),
		Limit: payroc.Int(
			1,
		),
	}
	_, invocationErr := client.Boarding.ProcessingAccounts.ListOwners(
		context.TODO(),
		request,
		option.WithHTTPHeader(
			http.Header{"X-Test-Id": []string{"TestBoardingProcessingAccountsListOwnersWithWireMock"}},
		),
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "TestBoardingProcessingAccountsListOwnersWithWireMock", "GET", "/processing-accounts/38765/owners", map[string]string{"before": "2571", "after": "8516", "limit": "1"}, 1)
}

func TestBoardingProcessingAccountsCreateReminderWithWireMock(
	t *testing.T,
) {
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewPayrocClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &boarding.CreateReminderProcessingAccountsRequest{
		ProcessingAccountId: "38765",
		IdempotencyKey:      "8e03978e-40d5-43e8-bc93-6894a57f9324",
		Body: &boarding.CreateReminderProcessingAccountsRequestBody{
			PricingAgreement: &payroc.PricingAgreementReminder{},
		},
	}
	_, invocationErr := client.Boarding.ProcessingAccounts.CreateReminder(
		context.TODO(),
		request,
		option.WithHTTPHeader(
			http.Header{"X-Test-Id": []string{"TestBoardingProcessingAccountsCreateReminderWithWireMock"}},
		),
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "TestBoardingProcessingAccountsCreateReminderWithWireMock", "POST", "/processing-accounts/38765/reminders", nil, 1)
}

func TestBoardingProcessingAccountsListTerminalOrdersWithWireMock(
	t *testing.T,
) {
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewPayrocClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &boarding.ListTerminalOrdersProcessingAccountsRequest{
		ProcessingAccountId: "38765",
		Status:              boarding.ListTerminalOrdersProcessingAccountsRequestStatusOpen.Ptr(),
		FromDateTime: payroc.Time(
			payroc.MustParseDateTime(
				"2024-09-08T12:00:00Z",
			),
		),
		ToDateTime: payroc.Time(
			payroc.MustParseDateTime(
				"2024-12-08T11:00:00Z",
			),
		),
	}
	_, invocationErr := client.Boarding.ProcessingAccounts.ListTerminalOrders(
		context.TODO(),
		request,
		option.WithHTTPHeader(
			http.Header{"X-Test-Id": []string{"TestBoardingProcessingAccountsListTerminalOrdersWithWireMock"}},
		),
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "TestBoardingProcessingAccountsListTerminalOrdersWithWireMock", "GET", "/processing-accounts/38765/terminal-orders", map[string]string{"status": "open", "fromDateTime": "2024-09-08T12:00:00Z", "toDateTime": "2024-12-08T11:00:00Z"}, 1)
}

func TestBoardingProcessingAccountsCreateTerminalOrderWithWireMock(
	t *testing.T,
) {
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewPayrocClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &boarding.CreateTerminalOrder{
		ProcessingAccountId: "38765",
		IdempotencyKey:      "8e03978e-40d5-43e8-bc93-6894a57f9324",
		TrainingProvider:    payroc.TrainingProviderPayroc.Ptr(),
		Shipping: &boarding.CreateTerminalOrderShipping{
			Preferences: &boarding.CreateTerminalOrderShippingPreferences{
				Method: boarding.CreateTerminalOrderShippingPreferencesMethodNextDay.Ptr(),
				SaturdayDelivery: payroc.Bool(
					true,
				),
			},
			Address: &boarding.CreateTerminalOrderShippingAddress{
				RecipientName: "Recipient Name",
				BusinessName: payroc.String(
					"Company Ltd",
				),
				AddressLine1: "1 Example Ave.",
				AddressLine2: payroc.String(
					"Example Address Line 2",
				),
				City:       "Chicago",
				State:      "Illinois",
				PostalCode: "60056",
				Email:      "example@mail.com",
				Phone: payroc.String(
					"2025550164",
				),
			},
		},
		OrderItems: []*payroc.OrderItem{
			&payroc.OrderItem{
				Type:               payroc.OrderItemTypeSolution,
				SolutionTemplateId: "Roc Services_DX8000",
				SolutionQuantity: payroc.Float64(
					1,
				),
				DeviceCondition: payroc.OrderItemDeviceConditionNew.Ptr(),
				SolutionSetup: &payroc.OrderItemSolutionSetup{
					Timezone: payroc.SchemasTimezoneAmericaChicago.Ptr(),
					IndustryTemplateId: payroc.String(
						"Retail",
					),
					GatewaySettings: &payroc.OrderItemSolutionSetupGatewaySettings{
						MerchantPortfolioId: payroc.String(
							"Company Ltd",
						),
						MerchantTemplateId: payroc.String(
							"Company Ltd Merchant Template",
						),
						UserTemplateId: payroc.String(
							"Company Ltd User Template",
						),
						TerminalTemplateId: payroc.String(
							"Company Ltd Terminal Template",
						),
					},
					ApplicationSettings: &payroc.OrderItemSolutionSetupApplicationSettings{
						ClerkPrompt: payroc.Bool(
							false,
						),
						Security: &payroc.OrderItemSolutionSetupApplicationSettingsSecurity{
							RefundPassword: payroc.Bool(
								true,
							),
							KeyedSalePassword: payroc.Bool(
								false,
							),
							ReversalPassword: payroc.Bool(
								true,
							),
						},
					},
					DeviceSettings: &payroc.OrderItemSolutionSetupDeviceSettings{
						NumberOfMobileUsers: payroc.Float64(
							2,
						),
						CommunicationType: payroc.OrderItemSolutionSetupDeviceSettingsCommunicationTypeWifi.Ptr(),
					},
					BatchClosure: &payroc.OrderItemSolutionSetupBatchClosure{
						Automatic: &payroc.AutomaticBatchClose{},
					},
					ReceiptNotifications: &payroc.OrderItemSolutionSetupReceiptNotifications{
						EmailReceipt: payroc.Bool(
							true,
						),
						SmsReceipt: payroc.Bool(
							false,
						),
					},
					Taxes: []*payroc.OrderItemSolutionSetupTaxesItem{
						&payroc.OrderItemSolutionSetupTaxesItem{
							TaxRate:  6,
							TaxLabel: "Sales Tax",
						},
					},
					Tips: &payroc.OrderItemSolutionSetupTips{
						Enabled: payroc.Bool(
							false,
						),
					},
					Tokenization: payroc.Bool(
						true,
					),
				},
			},
		},
	}
	_, invocationErr := client.Boarding.ProcessingAccounts.CreateTerminalOrder(
		context.TODO(),
		request,
		option.WithHTTPHeader(
			http.Header{"X-Test-Id": []string{"TestBoardingProcessingAccountsCreateTerminalOrderWithWireMock"}},
		),
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "TestBoardingProcessingAccountsCreateTerminalOrderWithWireMock", "POST", "/processing-accounts/38765/terminal-orders", nil, 1)
}

func TestBoardingProcessingAccountsListProcessingTerminalsWithWireMock(
	t *testing.T,
) {
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewPayrocClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &boarding.ListProcessingTerminalsProcessingAccountsRequest{
		ProcessingAccountId: "38765",
		Before: payroc.String(
			"2571",
		),
		After: payroc.String(
			"8516",
		),
		Limit: payroc.Int(
			1,
		),
	}
	_, invocationErr := client.Boarding.ProcessingAccounts.ListProcessingTerminals(
		context.TODO(),
		request,
		option.WithHTTPHeader(
			http.Header{"X-Test-Id": []string{"TestBoardingProcessingAccountsListProcessingTerminalsWithWireMock"}},
		),
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "TestBoardingProcessingAccountsListProcessingTerminalsWithWireMock", "GET", "/processing-accounts/38765/processing-terminals", map[string]string{"before": "2571", "after": "8516", "limit": "1"}, 1)
}
